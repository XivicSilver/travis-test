## Customize the test machine
machine:
  environment:
    GH_OWNER: nicolae-olariu
    GH_PROJECT_NAME: travis-test
    GH_BRANCH_NAME: deploy-staging
    DESTINATION_FOLDER: dist
    DEPLOY_SITE: deploy_site
    GH_PROJECT_URL: https://${GH_OAUTH_TOKEN}@github.com/${GH_OWNER}/${GH_PROJECT_NAME}

  # Version of ruby to use
  node:
    version:
      0.10.0

## Customize dependencies
dependencies:
  pre:
    - npm install
    - npm install -g bower grunt-build-control grunt-cli grunt
    - gem install compass
    - bower install

## Customize test commands
test:
  override:
    - npm test
  post:
    - grunt build
    - git fetch
    - git submodule add -b ${GH_BRANCH_NAME} ${GH_PROJECT_URL} ${DEPLOY_SITE} > /dev/null 2>&1
    - ls
    - cd ${DEPLOY_SITE}
    - pwd
    - ls
    - if git checkout ${GH_BRANCH_NAME}; then git checkout -b ${GH_BRANCH_NAME}; fi
    - cp -R ../${DESTINATION_FOLDER}/* .
    - cd ../${DESTINATION_FOLDER}
    - ls
    - pwd
